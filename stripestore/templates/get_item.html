<!DOCTYPE html>
<html lang=ru>
  <head>
    <meta http-equiv="Content-Security-Policy" content=" script-src https://js.stripe.com 'unsafe-inline';">
    <script src="https://js.stripe.com/v3/"></script>  
    <title>Buy {{ item.name }} </title>
  </head>
  <body>
    <h1>{{ item.name }}</h1>
    <p>{{ item.description }}</p>
    <p>1111</p>
    <button id="buy-button">Buy</button>
    <script type="text/javascript">
      var stripe = Stripe("{{ stripe_key }}");
      var buyButton = document.getElementById('buy-button');
      buyButton.addEventListener('click', function() {
        fetch('/api/v1/buy/{{item.id}}/', {method: 'GET'})
        .then(function(response) {
            return response.json();
          })
          .then(function(session) {
            session_id = session.session_id
            return stripe.redirectToCheckout({ sessionId: session_id });
          })
      });
    </script>
  </body>
</html>
